<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>World of Babi</title>

  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }
    canvas { display: block; }
  </style>
</head>

<body>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
  /* ===================== CORE ===================== */
  const scene = new THREE.Scene();
  scene.fog = new THREE.Fog(0x87ceeb, 30, 200);

  const camera = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000);
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(innerWidth, innerHeight);
  renderer.setPixelRatio(devicePixelRatio);
  document.body.appendChild(renderer.domElement);

  /* ===================== SKY ===================== */
  const sky = new THREE.Mesh(
    new THREE.SphereGeometry(500, 32, 32),
    new THREE.MeshBasicMaterial({ color: 0x87ceeb, side: THREE.BackSide })
  );
  scene.add(sky);
  const sunGeometry = new THREE.SphereGeometry(10, 32, 32);
const sunMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 });
const sunMesh = new THREE.Mesh(sunGeometry, sunMaterial);
sunMesh.position.set(100, 100, 50);
scene.add(sunMesh);

  /* ===================== LIGHT / DAY-NIGHT ===================== */
  const ambient = new THREE.AmbientLight(0xffffff, 0.4);
  scene.add(ambient);

  const sun = new THREE.DirectionalLight(0xffffff, 1.2);
  scene.add(sun);

  /* ===================== GROUND ===================== */
  const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(500, 500),
    new THREE.MeshStandardMaterial({ color: 0x3f7d3c })
  );
  ground.rotation.x = -Math.PI / 2;
  scene.add(ground);

  /* ===================== GRASS ===================== */
  for (let i = 0; i < 1000; i++) {
    const grass = new THREE.Mesh(
      new THREE.BoxGeometry(0.1, 1, 0.1),
      new THREE.MeshStandardMaterial({ color: 0x2e7d32 })
    );
    grass.position.set(
      (Math.random() - 0.5) * 500,
      0.5,
      (Math.random() - 0.5) * 500
    );
    scene.add(grass);
  }

  /* ===================== ROAD ===================== */
  const road = new THREE.Mesh(
    new THREE.BoxGeometry(8, 0.1, 300),
    new THREE.MeshStandardMaterial({ color: 0x5d4037 })
  );
  road.position.y = 0.05;
  scene.add(road);

  /* ===================== CLOUDS ===================== */
  const clouds = [];
  for (let i = 0; i < 20; i++) {
    const cloud = new THREE.Mesh(
      new THREE.SphereGeometry(5, 8, 8),
      new THREE.MeshBasicMaterial({ color: 0xffffff })
    );
    cloud.position.set(
      (Math.random() - 0.5) * 200,
      40 + Math.random() * 20,
      (Math.random() - 0.5) * 200
    );
    clouds.push(cloud);
    scene.add(cloud);
  }

  /* ===================== PLAYER ===================== */
  const player = new THREE.Group();
  scene.add(player);

  // Body
  const material = new THREE.MeshStandardMaterial({ color: 0x111 });

  // Torso
  const torso = new THREE.Mesh(new THREE.BoxGeometry(1, 1.5, 0.6), material);
  torso.position.y = 2.2;
  player.add(torso);

  // Head
  const head = new THREE.Mesh(new THREE.SphereGeometry(0.4), material);
  head.position.y = 3.3;
  player.add(head);

  // Arms
  const leftArm = new THREE.Mesh(new THREE.BoxGeometry(0.3, 1, 0.3), material);
  leftArm.position.set(-0.8, 2.2, 0);
  player.add(leftArm);

  const rightArm = leftArm.clone();
  rightArm.position.x = 0.8;
  player.add(rightArm);

  // Legs
  const leftLeg = new THREE.Mesh(new THREE.BoxGeometry(0.4, 1.2, 0.4), material);
  leftLeg.position.set(-0.3, 0.8, 0);
  player.add(leftLeg);

  const rightLeg = leftLeg.clone();
  rightLeg.position.x = 0.3;
  player.add(rightLeg);

  player.position.z = 20;

  /* ===================== CONTROLS ===================== */
  let yaw = 0, pitch = 0;
  let pointerActive = false;

  document.body.addEventListener("click", () => {
    renderer.domElement.requestPointerLock();
  });

  document.addEventListener("pointerlockchange", () => {
    pointerActive = document.pointerLockElement === renderer.domElement;
    document.body.style.cursor = pointerActive ? "none" : "default";
  });

  document.addEventListener("mousemove", e => {
  if (!pointerActive) return;
  yaw -= e.movementX * 0.002;
  pitch -= e.movementY * 0.002;
  pitch = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, pitch));
  camera.position.x = player.position.x - Math.sin(yaw) * 6 * Math.cos(pitch);
  camera.position.y = player.position.y + 4 + Math.sin(pitch) * 6;
  camera.position.z = player.position.z - Math.cos(yaw) * 6 * Math.cos(pitch);
  camera.lookAt(player.position.x, player.position.y + 2, player.position.z);
});

  /* ===================== MOVEMENT ===================== */
  const keys = {};
  addEventListener("keydown", e => keys[e.code] = true);
  addEventListener("keyup", e => keys[e.code] = false);

  let walkTime = 0;

  /* ===================== FOOTSTEP SOUND ===================== */
  const audio = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_ef7d7b2d9f.mp3");
  audio.loop = true;

  /* ===================== ANIMATION LOOP ===================== */
  function animate() {
    requestAnimationFrame(animate);

    // Day / night
    const t = Date.now() * 0.00005;
    sun.position.set(Math.sin(t) * 100, Math.cos(t) * 100, 50);
    ambient.intensity = Math.max(0.2, Math.cos(t) * 0.5);

    // Clouds move
    clouds.forEach(c => {
      c.position.x += 0.02;
      if (c.position.x > 200) c.position.x = -200;
    });

    const forward = new THREE.Vector3(Math.sin(yaw), 0, Math.cos(yaw));
    let moving = false;

    if (keys.KeyW) {
      player.position.addScaledVector(forward, -0.15);
      moving = true;
    }
    if (keys.KeyS) {
      player.position.addScaledVector(forward, 0.15);
      moving = true;
    }
    if (keys.KeyA) {
      player.position.addScaledVector(new THREE.Vector3(Math.cos(yaw), 0, -Math.sin(yaw)), 0.15);
      moving = true;
    }
    if (keys.KeyD) {
      player.position.addScaledVector(new THREE.Vector3(Math.cos(yaw), 0, -Math.sin(yaw)), -0.15);
      moving = true;
    }

    // Arm raise
    if (keys.ArrowLeft) {
      leftArm.rotation.x = Math.PI / 2;
    } else {
      leftArm.rotation.x = 0;
    }
    if (keys.ArrowRight) {
      rightArm.rotation.x = Math.PI / 2;
    } else {
      rightArm.rotation.x = 0;
    }

    // Walk animation
    if (moving) {
      walkTime += 0.15;
      leftLeg.rotation.x = -Math.sin(walkTime) * 0.6;
      rightLeg.rotation.x = Math.sin(walkTime) * 0.6;
      if (audio.paused) audio.play();
    } else {
      audio.pause();
      leftLeg.rotation.x = rightLeg.rotation.x = 0;
    }

    // Camera smoothing + shake
    camera.position.x = player.position.x - Math.sin(yaw) * 6;
    camera.position.y = player.position.y + 4 + Math.sin(walkTime) * 0.05;
    camera.position.z = player.position.z - Math.cos(yaw) * 6;
    camera.lookAt(player.position.x, player.position.y + 2, player.position.z);

    renderer.render(scene, camera);
  }
  animate();

  /* ===================== RESIZE ===================== */
  addEventListener("resize", () => {
    camera.aspect = innerWidth / innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
  });

  /* ===================== HOUSE FUNCTION ===================== */
  function createHouse(x, z, color) {
    const house = new THREE.Group();

    const body = new THREE.Mesh(
      new THREE.BoxGeometry(6, 4, 6),
      new THREE.MeshStandardMaterial({ color })
    );
    body.position.y = 2;
    house.add(body);

    const roof = new THREE.Mesh(
      new THREE.ConeGeometry(5, 3, 4),
      new THREE.MeshStandardMaterial({ color: 0x5a3825 })
    );
    roof.position.y = 5;
    roof.rotation.y = Math.PI / 4;
    house.add(roof);

    const door = new THREE.Mesh(
      new THREE.BoxGeometry(1.5, 2.5, 0.2),
      new THREE.MeshStandardMaterial({ color: 0xffffff })
    );
    door.position.set(0, 1.25, 3.1);
    house.add(door);

    const window = new THREE.Mesh(
      new THREE.BoxGeometry(1, 1, 0.2),
      new THREE.MeshStandardMaterial({ color: 0x88ccee })
    );
    window.position.set(-2, 2.5, 3.1);
    house.add(window);

    house.position.set(x, 0, z);
    scene.add(house);
    return house;
  }

  /* ===================== HOUSES ===================== */
  createHouse(-12, -40, 0xc48a5a); // Home
  createHouse(12, -80, 0x8aa5c4);  // About
  createHouse(-12, -120, 0x9ac48a); // Photos
  createHouse(12, -160, 0xc4a88a);  // Contact
</script>

</body>
</html>

